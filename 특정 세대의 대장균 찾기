WITH RECURSIVE GenerationCTE AS (
    -- 1단계: 1세대 찾기 (PARENT_ID가 NULL인 개체)
    SELECT ID, PARENT_ID, 1 AS GEN
    FROM ECOLI_DATA
    WHERE PARENT_ID IS NULL
    
    UNION ALL
    
    -- 2단계: 이전 세대를 부모로 둔 자식들을 찾으며 세대 번호 부여
    SELECT e.ID, e.PARENT_ID, g.GEN + 1
    FROM ECOLI_DATA e
    JOIN GenerationCTE g ON e.PARENT_ID = g.ID
)
-- 3세대 개체만 선택
SELECT ID
FROM GenerationCTE
WHERE GEN = 3
ORDER BY ID ASC;
